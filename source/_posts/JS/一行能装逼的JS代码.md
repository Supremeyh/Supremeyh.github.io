---
title: 一行能装逼的JS代码
comments: true
date: 2019-02-18 17:51:48
categories: JS
tags: ['JS']
---

> 你看不懂是你SB，我写的代码就要牛逼。

1、单行写一个评级组件
```JavaScript
"★★★★★☆☆☆☆☆".slice(5 - rate, 10 - rate)
```
定义一个变量rate是1到5的值，然后执行上面代码。rate是1，就是1星。

2、如何装逼用代码骂别人sb
```JavaScript
(!(~+[])+{})[--[~+""][+[]]*[~+[]] + ~~!+[]]+({}+[])[[~!+[]]*~+[]]
```
JS运算符的优先级、JS的类型转化
![JS运算符的优先级](/images/expressions-operator-precedence.jpg)
强制转换: String(sth)成字符串和调用 sth.toString() 方法的唯一不同之处在于，对null和undefined值强制类型转换可以生成字符串而不引发错误。


3、如何用代码优雅的证明自己nb
```JavaScript
([][[]]+[])[+!![]]+([]+{})[!+[]+!![]]
```

4、JavaScript 错误处理的方式的正确姿势
```JavaScript
try {
    something
} catch (e) {
    window.location.href = "http://stackoverflow.com/search?q=[js]+" + e.message;
}
```
5、论如何优雅的取整
 ```JavaScript
// 位运算只对整数有效，遇到小数时，会将小数部分舍去，只保留整数部分。所以，将一个小数与0进行二进制或运算，等同于对该数去除小数部分，即取整数位。
// 需要注意的是，这种取整方法不适用超过32位整数最大值2147483647的数。
a | 0 

// 口诀: 一个数与自身的取反值相加，等于-1
// 对一个整数连续两次二进制否运算，得到它自身
// 所有的位运算都只对整数有效。二进制否运算遇到小数时，也会将小数部分舍去，只保留整数部分
// 所以，对一个小数连续进行 两次取反，能达到取整效果
parseInt(a, 10)  === ~~a === 0 | a === a >> 0
 ```

6、从一行代码里面学点JavaScript
```JavaScript
[].forEach.call($$("*"),function(a){
    a.style.outline="1px solid #"+(~~(Math.random()*(1<<24))).toString(16)
})

// 等价于
Array.prototype.forEach.call(document.querySelectorAll('*'), 
  dom => dom.style.outline = `1px solid #${parseInt(Math.random() * Math.pow(2,24)).toString(16)}`)
```
> 解析
 document.all 返回所有的dom, 获得文档元素内所有 HTML 标记的集合
 document.all(0) 返回第一个元素
 $$('a') ,即document.querySelectorAll('a')，返回当前页面中所有锚元素的列表
 <<，有符号左移位，将运算数的二进制整体左移指定位数，低位用0补齐。
 number.toString(radix)，把number按radix进制转换成字符串。radix基数默认为10。 如(6).toString(2) 为 "110"
 parseInt(string, radix)，解析一个字符串string，以radix进制为基础返回一个整数。radix基数默认为10。 如parseInt("11",2)返回3 (2+1)
 parseInt("ffffff", 16) == 16777215 == 1000000000000000000000000 == 2^24-1 == 1<<24 - 1
 ~ 波浪操作符在JavaScript中被用来对一个变量进行取反
 ~~ 两次取反可以去掉一个浮点数的小数部分，~~的作用相当于parseInt。 ~~a == parseInt(a, 10) == 0 | a == a >> 0
 Math.random() 返回一个[0, 1)之间的随机数
 Math.floor(num) 向下取整，返回小于或等于num的最大整数，即返回num的整数部分
 Math.round(num) 四舍五入，返回num四舍五入后的整数
 Math.ceil(num)  向上取整，返回大于等于num的最小整数
 Math.floor(Math.random()*(max - min + 1) + min) 返回[min, max]之间的随机数

7、论如何优雅的取随机字符串
```JavaScript
Math.random().toString(16).substring(2)  // "7fdc07173c74c"

Math.random().toString(36).substring(2)  // "v8yaf0xdv5c"
```
str.substr(start,length) 在字符串中抽取从 start 下标开始的指定长度的字符。不建议使用。
str.substring(start,stop) 提取字符串中介于两个下标 [start,stop)之间的字符。与slice()和substr()方法不同，substring()不接受负的参数
str.slice(start,end) 提取字符串的某个部分，并以新的字符串返回被提取的部分 [start,stop)

8、js奇淫技巧 特殊转换
```JavaScript
(10)["toString"]() === "10"  // true

String([]) === ""  []进行字符串转换得到结果为""
String({}) === "[object Object]"  {}进行字符串转换得到结果为"[object Object]"
![] ===!"" === false  !后面的字符会被转为换布尔 
+[] === +"" === 0  +后面的字符会被转换为数值 
!+[] === true
true+[] === "true"
[]+[]=== ""  [] 后面跟的字符会被转换为字符串 
![]+[] === "false"
+!![] === 1 
"hello"[0] == "h"  检索字符串 
+("1"+"1") === 11  多个数字通过添加字符串表示在一起，然后整个表达式转换为数值类型 
(![]+[])[+!![]] === "a" 等价于 "false"[1] 
[][[]] + [] === "undefined"

// JavaScript的一个重要的特性是一个对象的属性可以通过点符号.或方括号[]访问。我们可以使用方括号代替点符号调用这些方法。
(10)["toString"]() === (10).toString() === (10).toString(10) === "10" 
```

9、另外一种undefined
void在JavaScript中是一个操作符，对传入的操作不执行并且返回undefined，但不建议这样写，因void 影响性能
```JavaScript
// 以下几种等价
var data
var data = undefined
var data = void 0
var data = void(0)
```

10、实现金钱格式化
```JavaScript
// 正则
var money = '1234567890'
money.replace(/\B(?=(\d{3})+(?!\d))/g, ',')   // 1,234,567,890

// reduce
function formatCash(str) {
    return str.split('').reverse().reduce((prev, next, index) => {
        return ((index % 3) ? next : (next + ',')) + prev
    })
}
formatCash(money) // 1,234,567,890

//  numObj.toLocaleString([locales [, options]])  注意为 number类型
(1234567890).toLocaleString('en', { style: 'decimal', currency: 'USD' })
```
> Number.prototype.toLocaleString([locales [, options]])
locales 参数用于指定格式化对象时使用的语言环境，默认为当前环境的语言，可以不传。
style 表示格式化时使用的样式，默认值是 decimal 纯数字，也可为 percent 百分比显示与 currency 货币显示。
style 设为 currency 时，必须同时指定currency 属性，否则报错。currency指定对应的货币，如 USD 、 EUR 与 CNY 等，不区分大小写。此外，还可以设置currencyDisplay指定货币符号的展示样式，默认值是 symbol即对应的符号，如 CNY 是 ￥。该属性的值也可以是 code 与 name.

以下，控制有效数字位数以及整数、小数位数，都是四舍五入。
minimumSignificantDigits：控制有效数字最少位数，设置后minimumIntegerDigits等属性会被忽略
maximumSignificantDigits：控制有效数字最多位数，设置后minimumIntegerDigits等属性会被忽略
useGrouping: true 有分隔符

minimumIntegerDigits: 指定整数最少位数，不够则用0去凑，即自动补0
minimumFractionDigits:  指定小数最少位数，不够则用0去凑，即自动补0
maximumFractionDigits: 指定小数最多位数 

如，(2333.3).toLocaleString('zh', { minimumFractionDigits: 2, minimumIntegerDigits:4, useGrouping: false });  //2333.30 

> Date.prototype.toLocaleString([locales [, options]])
hour12: true 使用十二小时制
weekday 、 era均可以取值为 narrow尽量短 、 short缩写 或 long正常。
year 、 month 、 day 、 hour 、 minute 、 second 与 timeZoneName，均可以取值为 numeric 与 2-digit ，是否仅用两位数字表示

如，


11、连等
```JavaScript
var a = b = 3
//等价于 从右向左 
b = 3
var a = b
```

12、如何最佳的让两个整数交换数值
```JavaScript
// 常规方法 缺点是整型数据溢出，对于32位字符最大表示数字是2147483647，如果是2147483645和2147483646交换就失败了
var a = 1, b = 2
a += b
b = a - b
a -= b;

// 黑科技方法
a ^= b
b ^= a
a ^= b
```

13、实现标准JSON的深拷贝
```JavaScript
JSON.parse(JSON.stringify(obj))
```
原理: 利用JSON.stringify() 将js对象序列化（JSON字符串），再使用JSON.parse来反序列化(还原)js对象。序列化的作用是存储(对象本身存储的只是一个地址映射，如果断电，对象将不复存在，因此需将对象的内容转换成字符串的形式再保存在磁盘上 )和传输（例如 如果请求的Content-Type是 application/x-www-form-urlencoded，则前端这边需要使用qs.stringify(data)来序列化参数再传给后端，否则后端接受不到；Content-Type 为 application/json;charset=UTF-8或者 multipart/form-data 则可以不需要）。
在使用 JSON.parse(JSON.stringify(obj))时应该注意一下几点：
如果obj里面有时间对象，则JSON.stringify后再JSON.parse的结果，时间将只是字符串的形式。而不是时间对象；
如果obj里有RegExp、Error对象，则序列化的结果将只得到空对象;
如果obj里有函数，undefined，则序列化的结果会把函数或 undefined丢失；
如果obj里有NaN、Infinity和-Infinity，则序列化的结果会变成null;
JSON.stringify()只能序列化对象的可枚举的自有属性，如果obj中的对象是有构造函数生成的，深拷贝后，会丢弃对象的constructor；
如果对象中存在循环引用的情况也无法正确实现深拷贝。

14、写出 hello world!
```JavaScript
([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[+[]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[]))+([]+{})[+!![]]+(!![]+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(+!![]+[]))
```

15、二进制浮点表示都不是精确的
```JavaScript
// 以下表达式都为true
parseInt(0.0000008) === 8  
0.1 + 0.2 === 0.30000000000000004
0.2-0.1 === 0.1
0.3-0.2 === 0.09999999999999998
```

16、最短的代码实现数组去重
```JavaScript
let arr = [1, "1", 2, 1, 1, 3]
let arr1 = [...new Set(arr)]  // [1, "1", 2, 3]  Set类似于数组，区别在于它所有的成员都是唯一的，不能有重复的值
let arr2 = Array.from(new Set(arr)) // [1, "1", 2, 3]  Array.from方法可以将 Set 结构转为数组
```

17、用最短的代码实现一个长度为m(6)且值都n(8)的数组
```JavaScript
Array(6).fill(8)
```

18、条件判断&&、||
```JavaScript
var a = b && 1
// 等价于
if (b) {
    a = 1
} else {
    a = b
}

var a = b || 1
// 等价于
if (b) {
    a = b
} else {
    a = 1
}
```

19、取出一个数组中的最大值和最小值
```JavaScript
var numbers = [5, 458 , 120 , -215 , 228 , 400]
var maxInNumbers = Math.max.apply(Math, numbers)
var minInNumbers = Math.min.apply(Math, numbers)

var maxInNumbers2 = Math.max(...[14, 3, 77])
```

20、Function构造函数
Function构造函数接受的参数中，第一个是要传入的参数名，第二个是函数内的代码（用字符串来表示）。
```JavaScript
var func = new Function('a', 'console.log(a)')
func('js')
```

21、一行代码递归实现斐波那契数列
```JavaScript
const fib = (f => f(f))(f => n => [1, 1][n] || f(f)(n - 1) + f(f)(n - 2))
```