---
title: 一行能装逼的JS代码
comments: true
date: 2019-02-18 17:51:48
categories: JS
tags: ['JS']
---

> 你看不懂是你SB，我写的代码就要牛逼。

1、单行写一个评级组件
```
"★★★★★☆☆☆☆☆".slice(5 - rate, 10 - rate)
```
定义一个变量rate是1到5的值，然后执行上面代码。rate是1，就是1星。

2、如何装逼用代码骂别人sb
```
(!(~+[])+{})[--[~+""][+[]]*[~+[]] + ~~!+[]]+({}+[])[[~!+[]]*~+[]]
```
JS运算符的优先级、JS的类型转化
![JS运算符的优先级](/images/expressions-operator-precedence.jpg)
强制转换: String(sth)成字符串和调用 sth.toString() 方法的唯一不同之处在于，对null和undefined值强制类型转换可以生成字符串而不引发错误。


3、如何用代码优雅的证明自己nb
```
([][[]]+[])[+!![]]+([]+{})[!+[]+!![]]
```

4、JavaScript 错误处理的方式的正确姿势
```
try {
    something
} catch (e) {
    window.location.href = "http://stackoverflow.com/search?q=[js]+" + e.message;
}
```
5、论如何优雅的取整
两次取反可以去掉一个浮点数的小数部分，~~的作用相当于parseInt。 
 ```
parseInt(a, 10)  === ~~a === 0 | a === a >> 0
 ```

6、从一行代码里面学点JavaScript
```
[].forEach.call($$("*"),function(a){
    a.style.outline="1px solid #"+(~~(Math.random()*(1<<24))).toString(16)
})

// 等价于
Array.prototype.forEach.call(document.querySelectorAll('*'), 
  dom => dom.style.outline = `1px solid #${parseInt(Math.random() * Math.pow(2,24)).toString(16)}`)
```
> 解析
 document.all 返回所有的dom, 获得文档元素内所有 HTML 标记的集合
 document.all(0) 返回第一个元素
 $$('a') ,即document.querySelectorAll('a')，返回当前页面中所有锚元素的列表
 <<，有符号左移位，将运算数的二进制整体左移指定位数，低位用0补齐。
 number.toString(radix)，把number按radix进制转换成字符串。radix基数默认为10。 如(6).toString(2) 为 "110"
 parseInt(string, radix)，解析一个字符串string，以radix进制为基础返回一个整数。radix基数默认为10。 如parseInt("11",2)返回3 (2+1)
 parseInt("ffffff", 16) == 16777215 == 1000000000000000000000000 == 2^24-1 == 1<<24 - 1
 ~ 波浪操作符在JavaScript中被用来对一个变量进行取反
 ~~ 两次取反可以去掉一个浮点数的小数部分，~~的作用相当于parseInt。 ~~a == parseInt(a, 10) == 0 | a == a >> 0
 Math.random() 返回一个[0, 1)之间的随机数
 Math.floor(num) 向下取整，返回小于或等于num的最大整数，即返回num的整数部分
 Math.round(num) 四舍五入，返回num四舍五入后的整数
 Math.ceil(num)  向上取整，返回大于等于num的最小整数
 Math.floor(Math.random()*(max - min + 1) + min) 返回[min, max]之间的随机数

7、论如何优雅的取随机字符串
```
Math.random().toString(16).substring(2)  // "7fdc07173c74c"

Math.random().toString(36).substring(2)  // "v8yaf0xdv5c"
```
str.substr(start,length) 在字符串中抽取从 start 下标开始的指定长度的字符。不建议使用。
str.substring(start,stop) 提取字符串中介于两个下标 [start,stop)之间的字符。与slice()和substr()方法不同，substring()不接受负的参数
str.slice(start,end) 提取字符串的某个部分，并以新的字符串返回被提取的部分 [start,stop)

8、js奇淫技巧 特殊转换
```
(10)["toString"]() === "10"  // true

String([]) === ""  []进行字符串转换得到结果为""
String({}) === "[object Object]"  {}进行字符串转换得到结果为"[object Object]"
![] ===!"" === false  !后面的字符会被转为换布尔 
+[] === +"" === 0  +后面的字符会被转换为数值 
!+[] === true
true+[] === "true"
[]+[]=== ""  [] 后面跟的字符会被转换为字符串 
![]+[] === "false"
+!![] === 1 
"hello"[0] == "h"  检索字符串 
+("1"+"1") === 11  多个数字通过添加字符串表示在一起，然后整个表达式转换为数值类型 
(![]+[])[+!![]] === "a" 等价于 "false"[1] 
[][[]] + [] === "undefined"

// JavaScript的一个重要的特性是一个对象的属性可以通过点符号.或方括号[]访问。我们可以使用方括号代替点符号调用这些方法。
(10)["toString"]() === (10).toString() === (10).toString(10) === "10" 
```

9、另外一种undefined
void在JavaScript中是一个操作符，对传入的操作不执行并且返回undefined，但不建议这样写，因void 影响性能
```
// 以下几种等价
var data
var data = undefined
var data = void 0
var data = void(0)
```

10、如何优雅的实现金钱格式化
```
// 正则魔法
var test1 = '1234567890'
var format = test1.replace(/\B(?=(\d{3})+(?!\d))/g, ',')   // 1,234,567,890

function formatCash(str) {
    return str.split('').reverse().reduce((prev, next, index) => {
        return ((index % 3) ? next : (next + ',')) + prev
    })
}
console.log(formatCash('1234567890')) // 1,234,567,890
```

11、连等
```
var a = b = 3
//等价于 从右向左 
b = 3
var a = b
```

12、如何最佳的让两个整数交换数值
```
// 常规方法 缺点是整型数据溢出，对于32位字符最大表示数字是2147483647，如果是2147483645和2147483646交换就失败了
var a = 1, b = 2
a += b
b = a - b
a -= b;

// 黑科技方法
a ^= b
b ^= a
a ^= b
```

13、实现标准JSON的深拷贝
```
JSON.parse(JSON.stringify(obj))
```
原理: 利用JSON.stringify() 将js对象序列化（JSON字符串），再使用JSON.parse来反序列化(还原)js对象。序列化的作用是存储(对象本身存储的只是一个地址映射，如果断电，对象将不复存在，因此需将对象的内容转换成字符串的形式再保存在磁盘上 )和传输（例如 如果请求的Content-Type是 application/x-www-form-urlencoded，则前端这边需要使用qs.stringify(data)来序列化参数再传给后端，否则后端接受不到；Content-Type 为 application/json;charset=UTF-8或者 multipart/form-data 则可以不需要）。
在使用 JSON.parse(JSON.stringify(obj))时应该注意一下几点：
如果obj里面有时间对象，则JSON.stringify后再JSON.parse的结果，时间将只是字符串的形式。而不是时间对象；
如果obj里有RegExp、Error对象，则序列化的结果将只得到空对象;
如果obj里有函数，undefined，则序列化的结果会把函数或 undefined丢失；
如果obj里有NaN、Infinity和-Infinity，则序列化的结果会变成null;
JSON.stringify()只能序列化对象的可枚举的自有属性，如果obj中的对象是有构造函数生成的，深拷贝后，会丢弃对象的constructor；
如果对象中存在循环引用的情况也无法正确实现深拷贝。

14、写出 hello world!
```
([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[+[]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[]))+([]+{})[+!![]]+(!![]+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(+!![]+[]))
```

15、二进制浮点表示都不是精确的
```
// 以下表达式都为true
parseInt(0.0000008) === 8  
0.1 + 0.2 == 0.30000000000000004
0.2-0.1 === 0.1
0.3-0.2 === 0.09999999999999998
```

16、最短的代码实现数组去重
```
let arr = [1, "1", 2, 1, 1, 3]
let arr1 = [...new Set(arr)]  // [1, "1", 2, 3]  Set类似于数组，区别在于它所有的成员都是唯一的，不能有重复的值
let arr2 = Array.from(new Set(arr)) // [1, "1", 2, 3]  Array.from方法可以将 Set 结构转为数组
```