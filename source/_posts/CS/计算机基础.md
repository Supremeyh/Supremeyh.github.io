---
title: 计算机基础
comments: true
date: 2019-10-07 20:16:10
categories: CS
tags: ['CS', 'Base']
---

> 计算机基础，更适合程序员的编程必备基础知识

### 编程必备基础：计算机组成原理、操作系统、计算机网络
形成计算机知识体系结构
理解计算机底层原理
工作实践中借鉴优秀设计
关注自身技能提升


### 计算机组成原理
#### 概述与组成
1. 发展历史
计算机发展四个阶段: 1946 电子管计算机(ENIAC) -> 1957 晶体管计算机(TX-0、PDP-1) -> 1964 集成电路计算机(操作系统出现) -> 1980 超大规模集成电路计算机  -> 至今
未来: 生物计算机、量子计算机

摩尔定律(英特尔创始人之一戈登·摩尔): 集成电路上可容纳的晶体管数目/微处理器性能/相同价格购得的性能，约每18个月就会提升一倍

2. 分类
超级计算机 1TFlop/s = 每秒一万亿次浮点计算  如，神威太湖之光
大型计算机
迷你计算机(普通服务器)
工作站
微型计算机(个人计算机)

3. 体系与结构
冯·诺伊曼体系结构 von Neumann architecture，美籍匈牙利数学家冯·诺伊曼于1946年提出存储程序原理。
计算机的数制采用二进制；计算机应该按照程序顺序执行；计算机硬件由运算器、控制器、存储器、输入设备和输出设备五大部分组成。

现代计算机结构: 在冯·诺伊曼体系基础上，解决CPU与存储设备之间的性能差异问题。CPU=控制器+运算器+存储器。

4. 层次与编程语言
虚拟机器: 操作系统(向下指令系统管理硬件资源，向上适配简易操作界面)、汇编语言(可翻译成可直接执行的机器语言)、高级语言、应用层
实际机器: 硬件逻辑(门、触发器等逻辑电路)、微程序机器(微指令集)、传统机器层(CPU指令集即机器指令)

5. 字符与编码集
ASCII码 7个比特位，95个可打印字符和33个不可打印字符
GBK 中文编码集
Unicode 兼容全球的字符集 utf-8

6. 总线
作用：解决不同设备之间的通信问题，如USB 通用串行总线、PCI 外置显卡、Thunderbolt
分类：片内总线(芯片内部，高度集成芯片内部的信息传输线)、系统总线(数据总线、地址总线、控制总线)

总线仲裁: 为了解决总线使用权的冲突问题
总裁方法: 链式查询、计数器定时查询、独立请求

7. 输入输出设备
CPU与IO设备通信: 程序中断(低速设备通知CPU中断信息异步方式)、DMA(直接存储器访问)

8. 存储器
分类: RAM随机存储器(随机读取，位置无关)、ROM只读存储器(只读不写)、串行存储器
层次结构: 按读写速度、存储容量、价格，分为 缓存、主存(RAM)、辅存

主存，RAM，内存，通过电容存储数据，隔段时间刷新一次，掉电所有数据丢失
辅存，磁盘
高速缓存，指标有命中率和访问效率。高速缓存替换策略随机算法、FIFO先进先出、LFU最不经常使用、LRU最近最少使用

9. 指令系统
机器指令由操作码和地址码组成，可执行数据传输、算术逻辑、移位、控制指令操作
寻址方式：指令寻址有顺序、跳跃寻址；数据寻址有立即、直接、间接寻址

10. 控制器
作用: 协调和控制计算机运行
类型: 程序计数器(存储下一条指令地址)、时序发生器(发送时序脉冲))、指令译码器、寄存器(指令、主存地址、主存数据、通用寄存器)、总线

11. 运算器
作用: 用来进行数据加工
类型: 数据缓冲器、ALU、通用寄存器、状态寄存器、总线

12. 指令执行的过程
取指令 (缓存中取指令、送到指令寄存器) -> 分析指令(指令译码器译码、发出控制信号、程序计数器+1) -> 执行指令(装载数据到寄存器、ALU处理数据、记录运算状态、送出运算结果)

CPU流水线设计，可同时处理多条指令，提升利用率

#### 计算
1. 进制计算基本知识
进位制是一种记数方式
二进制转换十进制，按权展开法
十进制转换二进制，重复相乘法

2. 二进制数据表示方法
原码：符号位为数值第一位，0正1负。 零的表示有正负两种，产生歧义，且减法运算复杂
补码：负数的补码等于反码+1
反码：负数的反码等于原码除符号位外按位取反

对于正数，原码 = 补码 = 反码

3. 二进制数据运算
定点数，小数点固定在某个位置的数
浮点数: 单精度浮点数，使用4字节，32位来表达浮点数; 双精度浮点数，使用8字节，64位来表达浮点数

定点数加法，符号位与数值位一同运算，并将符号位产生的进位丢掉

加减乘除

#### 实践
双向链表，每一个节点都要上一个和下一个节点的地址或引用
实现双向链表

实现缓存置换算法
FIFO 先进先出，把最新进入链表的节点淘汰
LFU 最不经常使用，记录频率，同频率节点按FIFO淘汰
LRU 最近最少使用，双向链表。把当前访问节点置于链表前面，保证链表头部节点是最近使用的
```py
class Node:
  def __init__(self, key, value):
    self.key = key
    self.value = value
    self.prev = None
    self.next = None
  def __str__(self):
    val = '{%d: %d}' %(self.key, self.value)
    return val
  def __repr__(self):
    val = '{%d: %d}' %(self.key, self.value)
    return val

class DuLinkList:
  def __init__(self, capacity=0xffff):
    self.capacity = capacity
    self.head = None
    self.tail = None
    self.size = 0
  def __add_head__(self, node):
    if not self.head:
      self.head = node
      self.tail = node
      self.head.next = None
      self.head.prev = None
    else:
      node.next = self.head
      self.head.prev = node
      self.head = node
      self.head.prev = None
    self.size += 1
    return node

```

### 操作系统
#### 概要
概念: 操作系统是管理计算机硬件和软件资源的计算机程序，提供让用户和系统交互的操作界面

演进: 无操作系统、批处理系统、分时系统

特性： 并发(在一个时间间隔)、共享、虚拟(时分复用、空分复用)、异步性

#### 五大功能
进程管理(进程实体、状态模型、进程同步)、作业(进程调度、死锁)、存储(内存分配回收、段页式、虚拟内存)、文件、设备管理

#### 进程 
进程 Process 是系统进行资源分配和调度的基本单位
进程实体包含标识符、处理机状态、调度信息、控制信息。优先级、程序计数器、内存指针、上下文数据、IO状态信息、记账信息
进程控制块PCB，描述和控制进程运行的通用数据结构

线程 Thread 操作系统进行运行调度的最小单位

进程的五状态: 创建(分配PCB)、就绪(只差CPU资源)、执行(获得CPU)、阻塞(放弃CPU)、终止(系统清理，归还PCB)

* 进程同步
原因：生产者消费者问题、哲学家进餐问题(彼此间没有通信), 对竞争资源在多进程间进行使用次序的协调
原则：空闲让进、忙则等待、有限等待、让权等待
方法： 消息队列、共享存储、信号量

* 线程同步
进程的线程要共享资源，因此进程内多线程也需要同步
方法：互斥量、读写锁、自旋锁、条件变量

* Linux的进程管理
进程类型: 前台进程(具有终端，可以和用户交互)、后台进程(无终端，优先级低，以&结尾)、守护进程(daemon 在系统引导时启动，直到系统关闭，名字常以d结尾)
进程标记: 进程ID 唯一标记

操作系统提供 fork 函数接口创建进程，进程父子关系可通过命令 pstree 查看

特殊进程
ID 为 0 的进程是 idle 进程，是系统创建的第一个进程
ID 为 1 的进程是 init 进程，是0号进程的子进程，完成系统初始化，也是所有用户进程的祖先进程

进程标记  可通过 man ps 查看
R TASK_RUNNING 执行状态 
S TASK_INTERRUPTIBLE  可中断的睡眠状态
D TASK_UNINTERRUPTIBLE  不可中断的睡眠状态
T TASK_STOPPED or TASK_TRACED 暂停状态或跟踪状态
Z TASK_DEAD - EXIT_ZOMBIE 退出状态，进程成为僵尸进程

linux 操作进程常用命令
ps aux | grep python3 列出当前进程
ps -ef -forest 查看进程树
top  所有进程的状态
kill 发送指定信号给进程
kill -l 查看操作系统支持的信号

#### 作业管理
* 进程调度
进程调度: 通过决策决定哪个就绪进程可以获得CPU使用权。保留旧进程运行信息，清除旧进程(收拾包袱)，选择新进程，准备运行环境并分配CPU(新进驻)
三个机制: 就绪队列的排队机制、选择运行进程的委派机制、新老进程上下文切换机制
种类: 非抢占式、抢占式调度
算法: 先来先服务、短进程优先、高优先权优先、时间片轮转调度算法

* 死锁
死锁是指两个或两个以上的进程在执行过程中，由于竞争资源或者进程顺序调度不当，彼此通信而造成的一种阻塞的现象，若无外力作用，它们都将无法推进下去。此时称系统处于死锁状态或系统产生了死锁，这些永远在互相等待的进程称为死锁进程

产生的四个必要条件: 互斥、请求保持、不可剥夺、环路等待条件

预防死锁的方法: 破坏以上其中一个必要条件

银行家算法, 由已分配资源表、所需资源表和可分配资源表计算哪个进程先执行

* 内存分配与回收
分配过程： 单一连续分配、固定分区分配、动态分区分配(空闲表、空闲链)
回收过程: 空闲区与回收区的合并

* 段页式存储管理
页式存储管理
段式存储管理
段页式存储管理: 先将用户程序分成若干个段，再把每个段分成若干个页，并为每一个段赋予一个段名

* 虚拟内存
程序的局部性原理
置换算法

* Linux存储管理
buddy 算法，解决系统物理内存不足，内存外碎片的问题。 向上取整为2的幂大小
swap 交换空间，冷启动内存依赖、系统睡眠依赖、大进程空间依赖


